# Часть 4: Мигаем на C

Знание ассемблера важно, но многие программы разумней писать на C. В этой части
мы перепишем предыдущий пример на C. Попутно познакомимся с тем, как линковать
результаты компиляции кода на С.

Для начала напишем программу на C, состоящую из одной пустой функции.
Скомпилируем её и исследуем получившийся объектный файл.

`blinkc.c`:

```c
void reset_exception_handler(void)
{
}
```

```
arm-none-eabi-gcc -c -o blinkc.o blinkc.c

$ arm-none-eabi-nm blinkc.o
00000000 T reset_exception_handler

$ arm-none-eabi-objdump -D blinkc.o

blinkc.o:     file format elf32-littlearm


Disassembly of section .text:

00000000 <reset_exception_handler>:
   0:	e52db004 	push	{fp}		@ (str fp, [sp, #-4]!)
   4:	e28db000 	add	fp, sp, #0
   8:	e1a00000 	nop			@ (mov r0, r0)
   c:	e28bd000 	add	sp, fp, #0
  10:	e49db004 	pop	{fp}		@ (ldr fp, [sp], #4)
  14:	e12fff1e 	bx	lr

Disassembly of section .comment:

00000000 <.comment>:
...


Disassembly of section .ARM.attributes:

00000000 <.ARM.attributes>:
...

```

Итак мы видим, что объектный файл `blinkc.o` экспортирует символ
`reset_exception_handler`, так же, как это делал файл `blink.o` в предыдущей
части.

Он также содержит секцию `.text` с кодом функции `reset_exception_handler`.
Несмотря на то, что функция вроде бы пустая, компилятор кода там нагенерировал
немало. Но на самом деле это потому, что мы компилируем без оптимизации. Если
компилятору передавать флаг `-Os` или `-O3`, то результаты будут гораздо лучше.
Но пока и так сойдёт.

Кроме того добавилась секция `<.comment>`, которая содержит ещё больше служебной
информации. На неё тоже не будем обращать внимания.

Наш код на ассемблере содержал секцию `code`. Теперь код на C содержит секцию
`.text`, поэтому нужно не забыть поменять скрипт линкера:

```
SECTIONS {
    main 0x08000000 : {
        LONG(0x20000000 + 20K);
        LONG(reset_exception_handler | 1);
        . = 0x130;
        blinkc.o(.text)
    }
}
```

За исключением названия секции всё остальное можно оставить без изменений. Этого
достаточно, чтобы получить работающую программу.

Теперь осталось лишь перевести код с ассемблера на C.

`blinkc.c`:

```c

```
